## Step 1 – 요구사항 수집 & 구조화 산출물

**(FRD v1 / NFRD v1 / Use Case / Priority Matrix)**

### 프로젝트명

**Unified Storage Backend (개인용 NAS + 멀티 클라우드 통합)**

### 버전

* Document Version: **v1.0**
* Scope: **Read-only, API-first**
* 작성 단계: **Step 1 종료 산출물**

---

## 1. 프로젝트 전제 (Step 0 요약 반영)

* Unified Storage Backend는 여러 Storage Provider를 **논리적으로 통합**하는 백엔드 시스템이다.
* NAS는 여러 Provider 중 하나이다.
* v1은 **Read-only**만 지원한다.
* API-first, Connector 기반 구조를 따른다.
* UI / Sync / Write 기능은 v1 범위가 아니다.

---

## 2. Functional Requirements Document (FRD v1)

### FR-1. Storage Provider 등록 및 관리

* NAS, Cloud Storage를 Provider로 등록할 수 있어야 한다.
* Provider는 개별 인증/설정을 가진다.
* Provider 장애는 전체 서비스에 영향을 주지 않는다.

**Acceptance Criteria**

* Provider 등록 시 성공/실패 명확 반환
* 장애 Provider는 DEGRADED/DOWN 상태로 분리 표시

---

### FR-2. Provider 루트 기반 파일/폴더 목록 조회

* Provider별 루트(`/nas`, `/gdrive` 등)에서 파일/폴더를 조회한다.
* 공통 API 스펙으로 조회 가능해야 한다.
* Pagination 또는 Cursor 기반 조회를 지원한다.

**Acceptance Criteria**

* 대용량 디렉토리에서도 안정적으로 조회 가능
* Provider별 응답 차이는 내부에서 흡수

---

### FR-3. Provider 네임스페이스 분리 유지

* 통합 시스템이지만 Provider 루트는 병합하지 않는다.
* 동일한 파일명/경로가 있어도 충돌하지 않는다.

**Acceptance Criteria**

* 모든 응답에 provider 식별 가능
* `/nas/...`, `/gdrive/...` 형태 유지

---

### FR-4. 파일/폴더 단건 메타데이터 조회

* 전역 유니크 ID(`node_id`)로 파일/폴더를 조회할 수 있어야 한다.

**Acceptance Criteria**

* node_id는 불변
* path 변경과 무관하게 동일 Node 조회 가능

---

### FR-5. 파일 다운로드 (v1 포함)

* node_id 기반으로 파일 다운로드를 지원한다.
* 대용량 파일도 안정적으로 처리해야 한다.

**Acceptance Criteria**

* Streaming 기반 (메모리 고정 점유 없음)
* Provider 특성에 따라 redirect/presigned 허용

---

### FR-6. NAS 인덱스 기반 조회

* NAS 파일 시스템은 직접 조회하지 않고 **Index DB 기반**으로 조회한다.
* 인덱스 상태를 확인할 수 있어야 한다.

**Acceptance Criteria**

* 수십만 파일에서도 조회 성능 유지
* 인덱스 재구축 가능

---

## 3. Non-Functional Requirements Document (NFRD v1)

### 성능

* 목록 조회 p95 < 1초 (cache/index hit 기준)
* 다운로드는 streaming 방식

### 확장성

* Provider Connector 플러그인 구조
* 신규 Provider 추가 시 Core 수정 최소화

### 안정성

* Partial failure 허용
* Provider 단위 장애 격리

### 보안

* Credential 암호화 저장
* Read-only 최소 권한 원칙

### 운영

* Provider 상태 모니터링
* trace_id 포함 로그

---

## 4. Core Use Case & User Story

### UC-1. Provider 루트 기반 파일 탐색

> 사용자는 여러 스토리지의 파일을
> 하나의 API 패턴으로 탐색하고 싶다.

---

### UC-2. Provider 장애 상황

> 특정 Provider가 장애여도
> 나머지 파일은 계속 조회하고 싶다.

---

### UC-3. 파일 다운로드

> 사용자는 node_id로 파일을 안정적으로 다운로드하고 싶다.

---

## 5. Requirement Priority Matrix (MoSCoW)

### Must Have

* Provider 등록/관리
* Provider 루트 기반 조회
* Read-only 접근
* NAS Index DB
* 파일 다운로드

### Should Have

* Pagination/Cursor
* Provider health 상태

### Could Have

* 이름 검색
* Presigned URL 최적화

### Won’t Have (v1)

* Write/Sync/UI
* 공유/권한 관리

---